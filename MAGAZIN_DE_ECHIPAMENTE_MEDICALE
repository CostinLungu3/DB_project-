CREATE TABLE ANGAJATI
(ID_ANGAJAT NUMBER(10) CONSTRAINT pk_angajati PRIMARY KEY,
NUME_ANGAJAT VARCHAR2(20) NOT NULL,
PRENUME_ANGAJAT VARCHAR2(30) NOT NULL,
CNP NUMBER(13) NOT NULL,
ID_RAION NUMBER(5) NOT NULL,
SALARIU_ANGAJAT NUMBER (10) NOT NULL,
TELEFON_ANGAJAT NUMBER(15) NOT NULL
);

CREATE TABLE RAIOANE
(
ID_RAION NUMBER(10) CONSTRAINT pk_raioane PRIMARY KEY,,
DENUMIRE_RAION VARCHAR2(20) NOT NULL
);

CREATE TABLE PRODUSE
(
ID_PRODUS NUMBER(10) CONSTRAINT pk_produse PRIMARY KEY,
NUME_PRODUS VARCHAR2(30) NOT NULL,
PRET_PRODUS NUMBER(10) NOT NULL,
DETALII_PRODUS VARCHAR2(50) NOT NULL
);

CREATE TABLE CLIENTI
(
ID_CLIENT NUMBER(10) CONSTRAINT pk_clienti PRIMARY KEY,
NUME_CLIENT VARCHAR2(20) NOT NULL,
EMAIL_CLIENT VARCHAR2(30) NOT NULL,
TELEFON_CLIENT NUMBER(15) NOT NULL
);

CREATE TABLE FURNIZORI
(
ID_FURNIZOR NUMBER(10) NOT NULL,
NUME_FURNIZOR VARCHAR2(20) NOT NULL,
ID_PRODUS NUMBER(10),
PRET_PRODUS NUMBER(10) NOT NULL,
CANTITATE_PRODUS NUMBER(10) NOT NULL,
PRIMARY KEY (ID_FURNIZOR, ID_PRODUS)
);

CREATE TABLE COMENZI
(
ID_COMANDA NUMBER(10) CONSTRAINT pk_comenzi PRIMARY KEY,
DATA_COMANDA DATE NOT NULL,	
ID_CLIENT NUMBER(10) NOT NULL,
ID_ANGAJAT NUMBER(10) NOT NULL,
ID_PRODUS NUMBER(10) NOT NULL,
PRET_PRODUS NUMBER(10) NOT NULL,
CANTITATE_PRODUS NUMBER(10) NOT NULL
);

ALTER TABLE ANGAJATI
ADD FOREIGN KEY (ID_RAION) REFERENCES RAIOANE (ID_RAION);

ALTER TABLE FURNIZORI
ADD FOREIGN KEY (ID_PRODUS) REFERENCES PRODUSE (ID_PRODUS);

ALTER TABLE COMENZI
ADD FOREIGN KEY (ID_PRODUS) REFERENCES PRODUSE (ID_PRODUS);

ALTER TABLE COMENZI
ADD FOREIGN KEY (ID_CLIENT) REFERENCES CLIENTI (ID_CLIENT);

ALTER TABLE COMENZI
ADD FOREIGN KEY (ID_ANGAJAT) REFERENCES ANGAJATI (ID_ANGAJAT);

DROP TABLE FURNIZORI CASCADE CONSTRAINTS;

FLASHBACK TABLE FURNIZORI TO BEFORE DROP;

ALTER TABLE PRODUSE
ADD(ID_FURNIZOR NUMBER (10));

ALTER TABLE ANGAJATI
MODIFY (SALARIU_ANGAJAT NUMBER(10));

UPDATE PRODUSE
SET NUME_PRODUS=’SPIROMETRU’
WHERE ID_PRODUS=12

ALTER TABLE CLIENTI
RENAME COLUMN PRENUME_CLIENT TO EMAIL;

INSERT INTO ANGAJATI VALUES (1,'Ion','Marin',1700909534123,11,2500,0745125613);
INSERT INTO ANGAJATI VALUES (2,'Agache','Vasile',1770305334673,11,2800,0765375468);
INSERT INTO ANGAJATI VALUES (3,'Oprea','Ileana',2801122536773,22,3000,0725892613);
INSERT INTO ANGAJATI VALUES (4,'Popa','Silviu',1730325535579,22,2600,0726303489);
INSERT INTO ANGAJATI VALUES (5,'Enache','George',1600909534123,33,2700,0767589135);

INSERT INTO PRODUSE VALUES (10,'CPMOTION',5900,'FIZIOTERAPIE');
INSERT INTO PRODUSE VALUES (11,'TECAR',9200,'FIZIOTERAPIE');
INSERT INTO PRODUSE VALUES (12,'SPIROMETRIE',4500,'CARDIOLOGIE');
INSERT INTO PRODUSE VALUES (13,'EKG',7500,'CARDIOLOGIE');
INSERT INTO PRODUSE VALUES (14,'EMSCULPT',8300,'ESTETICA');

INSERT INTO RAIOANE VALUES (11,'FIZIOTERAPIE');
INSERT INTO RAIOANE VALUES (22,'CARDIOLOGIE');
INSERT INTO RAIOANE VALUES (33,'ESTETICA');

INSERT INTO FURNIZORI VALUES (100,'WINBACK',11,9200,10);
INSERT INTO FURNIZORI VALUES (100,'WINBACK',12,4500,5);
INSERT INTO FURNIZORI VALUES (101,'BTL',10,5900,9);
INSERT INTO FURNIZORI VALUES (101,'BTL',13,7500,12);
INSERT INTO FURNIZORI VALUES (102,'LINEMED',14,8300,7);

INSERT INTO CLIENTI VALUES (1,'MERAMED','CONTACT@MERAMED.RO',0726781899);
INSERT INTO CLIENTI VALUES (2,'SANTEVIE','CONTACT@SANTEVIE.RO',0745167773);
INSERT INTO CLIENTI VALUES (3,'BEHEALTH','CONTACT@BEHEALTH.RO',0736458195);
INSERT INTO CLIENTI VALUES (4,'MEDICOVER','CONTACT@MEDICOVER.RO',0729793455);
INSERT INTO CLIENTI VALUES (5,'ABEAUTYCLINIQUE','CONTACT@ABEAUTYCLINIQUE.RO',0744852456);

INSERT INTO comenzi VALUES (1,1,2,11,9200,3,to_date('13-01-2019','DD-MM-YYYY'));
INSERT INTO comenzi VALUES (2,2,3,12,4500,4,to_date('23-03-2019','DD-MM-YYYY'));
INSERT INTO comenzi VALUES (3,4,1,11,9200,2,to_date('17-06-2019','DD-MM-YYYY'));
INSERT INTO comenzi VALUES (4,1,2,10,5900,1,to_date('15-02-2019','DD-MM-YYYY'));
INSERT INTO comenzi VALUES (5,3,1,10,5900,2,to_date('26-09-2019','DD-MM-YYYY'));
INSERT INTO comenzi VALUES (6,5,5,14,8300,4,to_date('14-05-2019','DD-MM-YYYY'));
INSERT INTO comenzi VALUES (7,4,4,13,7500,3,to_date('20-10-2019','DD-MM-YYYY'));

UPDATE CLIENTI
SET TELEFON_CLIENT='0736456852'
WHERE ID_CLIENT=4; 

DELETE FROM COMENZI
WHERE ID_COMANDA='6';
ROLLBACK;

SELECT *
FROM COMENZI;

SELECT *
FROM ANGAJATI
WHERE SALARIU_ANGAJAT> 2750;

SELECT  * 
FROM CLIENTI
WHERE (NUME_CLIENT) LIKE 'M%';

SELECT DISTINCT NUME_ANGAJAT, PRENUME_ANGAJAT, SALARIU_ANGAJAT
FROM ANGAJATI
ORDER BY SALARIU_ANGAJAT DESC;

SELECT DISTINCT NUME_ANGAJAT, PRENUME_ANGAJAT, SALARIU_ANGAJAT
FROM ANGAJATI
ORDER BY NUME_ANGAJAT ASC;

SELECT *
FROM PRODUSE
WHERE PRET_PRODUS < 7000;

SELECT *
FROM ANGAJATI
WHERE ID_RAION=11;

UPDATE ANGAJATI
SET SALARIU_ANGAJAT=SALARIU_ANGAJAT+200
WHERE SALARIU_ANGAJAT<3000;
SELECT * FROM ANGAJATI;

SELECT  * 
FROM COMENZI
WHERE CANTITATE_PRODUS >2
ORDER BY DATA_COMANDA;

SELECT ID_CLIENT, DATA_COMANDA
FROM COMENZI
WHERE ID_PRODUS=11;

SELECT *
FROM COMENZI
WHERE DATA_COMANDA >=TO_DATE('01-06-2019','DD-MM-YYYY');

SELECT *
FROM COMENZI WHERE ID_ANGAJAT=2 
AND DATA_COMANDA<TO_DATE('01-07-2019','DD-MM-YYYY');

SELECT ID_PRODUS, PRET_PRODUS, (C.PRET_PRODUS * C.CANTITATE_PRODUS) AS TOTAL
FROM COMENZI C
ORDER BY TOTAL;

SELECT CL.NUME_CLIENT, CL.ID_CLIENT, PRO.NUME_PRODUS, COM.CANTITATE_PRODUS, COM.PRET_PRODUS, COM.DATA_COMANDA 
FROM CLIENTI CL,
COMENZI COM,
PRODUSE PRO
WHERE CL.ID_CLIENT=COM.ID_CLIENT
AND PRO.ID_PRODUS=COM.ID_PRODUS
ORDER BY DATA_COMANDA DESC;

SELECT PRO.*
FROM PRODUSE PRO,
RAIOANE RAI
WHERE PRO.DETALII_PRODUS=RAI.DENUMIRE_RAION(+)
ORDER BY PRET_PRODUS ASC;

SELECT COM.DATA_COMANDA ||' ESTE COMANDA DATA IN PRIMELE 5 LUNI ALE ANULUI DE CATRE CLIENTUL CU ID-UL '|| CO.ID_CLIENT
FROM COMENZI COM,
COMENZI CO
WHERE COM.ID_COMANDA=CO.ID_COMANDA
AND COM.DATA_COMANDA < TO_DATE('01-06-2019','DD-MM-YYYY');

SELECT CL.*
FROM CLIENTI CL,
COMENZI COM,
PRODUSE PRO
WHERE CL.ID_CLIENT=COM.ID_CLIENT
AND COM.ID_PRODUS=PRO.ID_PRODUS
AND NUME_PRODUS = (SELECT NUME_PRODUS
FROM PRODUSE
WHERE NUME_PRODUS ='CPMOTION');

SELECT NUME_PRODUS, 
LOWER (NUME_PRODUS)
FROM PRODUSE;

SELECT PRENUME_ANGAJAT,
UPPER (PRENUME_ANGAJAT)
FROM ANGAJATI;

SELECT DENUMIRE_RAION, INITCAP(DENUMIRE_RAION)
FROM RAIOANE;

SELECT COM.DATA_COMANDA ||' ESTE COMANDA DATA IN PRIMELE 5 LUNI ALE ANULUI DE CATRE CLIENTUL CU ID-UL '|| CO.ID_CLIENT
FROM COMENZI COM,
COMENZI CO
WHERE COM.ID_COMANDA=CO.ID_COMANDA
AND COM.DATA_COMANDA < TO_DATE('01-06-2019','DD-MM-YYYY');

SELECT CONCAT(NUME_ANGAJAT, PRENUME_ANGAJAT)
FROM ANGAJATI;

SELECT NUME_PRODUS, LENGTH(NUME_PRODUS)
FROM PRODUSE;

SELECT NUME_ANGAJAT, PRENUME_ANGAJAT, CNP
FROM ANGAJATI
WHERE SUBSTR(CNP,2,1)=7;
SELECT ROUND(73.976,5), 
ROUND(73.977,0) 
FROM DUAL;

SELECT ROUND(sysdate, 'MONTH') 
FROM DUAL;

SELECT TRUNC(73.976,5), 
TRUNC(73.977,0) 
FROM DUAL;

SELECT TRUNC(sysdate, 'YEAR') 
FROM DUAL;

SELECT DATA_COMANDA, ROUND(MONTHS_BETWEEN(sysdate, DATA_COMANDA)) NR_LUNI
FROM COMENZI;

SELECT DATA_COMANDA, TO_CHAR(DATA_COMANDA,'MM-YYYY')
FROM COMENZI;
SELECT *
FROM COMENZI
WHERE DATA_COMANDA BETWEEN TO_DATE('01-03-2019','DD-MM-YYYY') AND TO_DATE('31-10-2019','DD-MM-YYYY');

SELECT AVG(com.CANTITATE_PRODUS  *  com. PRET_PRODUS)
FROM COMENZI com;

SELECT MAX(com. CANTITATE_PRODUS *  com. PRET_PRODUS)
FROM COMENZI com;

SELECT MIN(com. CANTITATE_PRODUS  *  com. PRET_PRODUS)
FROM COMENZI com;

SELECT SUM(com. CANTITATE_PRODUS  *  com.PRET_PRODUS) 
FROM COMENZI com;

SELECT * FROM angajati WHERE salariu_angajat BETWEEN 2400 AND 3500
MINUS
SELECT * FROM angajati WHERE salariu_angajat IN (3000);

SELECT *
FROM COMENZI
WHERE ID_PRODUS=10
UNION
SELECT *
FROM COMENZI
WHERE ID_PRODUS=11;

CREATE OR REPLACE VIEW v_angajati
AS SELECT * FROM angajati
WHERE id_raion=12;

SELECT * FROM v_angajati;

UPDATE v_angajati
SET salariu_angajat = salariu_angajat + 300;

DROP VIEW v_angajati;

SELECT * 
FROM USER_INDEXES;


SELECT * FROM ANGAJATI 
WHERE UPPER(NUME_ANGAJAT) = 'OPREA';


CREATE INDEX idx_upper_prenume ON ANGAJATI(UPPER(NUME_ANGAJAT));

CREATE SEQUENCE seq_nrcomanda
START WITH 300 INCREMENT BY 50
MAXVALUE 1000 NOCYCLE;

SELECT * 
FROM USER_SEQUENCES;
